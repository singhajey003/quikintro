<!--
  This component contains all messages, invitations and meeting requests.

  @group QI Elements
  @element qi-invite-page
-->
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html"> 
<link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="../qi-trait/qi-traitlist.html">
<link rel="import" href="../qi-avatar/qi-avatar.html">
<link rel="import" href="../qi-card/qi-swipe-page-behavior.html">

<link rel="import" href="./../qi-new-theme.html">
<link rel="import" href="../qi-persona/qi-persona-field.html">

<link rel="import" href="../qi-field/qi-field-decorator.html">
<link rel="import" href="../qi-contact/qi-contact-tray.html">
<link rel="import" href="../qi-twitter/qi-twitter-panel.html">


<dom-module id="qi-invite-page">


	<style is="custom-style">

	.band{
		max-height: 100px
		background-color: #5c91cc;
	}

	.avatar{
		margin-left: 10px;
		margin-right: 10px;
	}

	.details{
		
	}
	.contacts{
	}
	.contactBlock{
		margin: auto;
	}

	.titleco{
		margin-right: 25px;
	}
	.score{
		color: #5c91cc;
		max-width: 50px;
		margin-right: 1px;
	}
	.pct{
		color: #5c91cc;
		max-width: 30px;
	}

	</style>


	<template>

		<iron-ajax id="ajax"
		auto="true"
	  url="../data/aacr15.tweets.json"
	  handleAs="json"
	  last-response="{{response}}" on-error="errorHandler"></iron-ajax>

	<iron-localstorage name="personas" value="{{personas}}"></iron-localstorage>

	<div class="detail-page" on-track="handlePageSwipe">
		<div><span>[[fullname]]</span></div>

		<div class="band horizontal layout">

			<div class="avatar" >
				<qi-avatar url="[[model.sender.avatar]]"></qi-avatar>
			</div>

			<div class="details">
				<div><span class="titleco">[[titleco]]</span></div>

				<div><qi-persona-field model="[[personas]]" personal = "[[model.sender.persona]]"></qi-persona-field></div>
				

			</div>

		</div>

		<div class="layout horizontal">
			<div class="flex layout vertical contactBlock">

				<qi-field-decorator is-stacked="true" label="Common Contacts" >
				<span class="contacts">[[model.sender.contacts]]</span>
			</qi-field-decorator>
		</div>

		<div class="flex layout vertical">
			<label>Persona Match</label>
			<div class="layout horizontal">
				<span class="score">[[model.sender.score]]</span><span class="pct">%</span>
			</div>
		</div>

		</div>

		<div class="traits">
			<label>Matching Traits</label>
			<qi-traitlist traits="[[model.sender.interests]]"></qi-traitlist>
		</div>

		

		<div class="summary">
			<qi-field-decorator is-stacked="true" label="Summary" >
				<span>[[model.sender.summary]]</span>
			</qi-field-decorator>
	
		</div>


		<div class="tweets">

			<label>Matching tweets</label>
			<template is="dom-repeat" items="[[response.statuses]]" as="tweet">
				<qi-tweet-card id="[[articleId]]" cardstyle="card card-wrapper layout horizontal" class="selectable-card" model="[[tweet]]" ></qi-tweet-card>
			</template>
		</div>

	</div>

	</template>

	<script>

		Polymer({
			is: 'qi-invite-page',
			behaviors: [QiSwipePageBehavior],
	
			properties: {
				model:{
					type: Object
				},

				fullname: {
					type: String,
					computed: '_computeFullName(model)'
				},
				titleco: {
					type: String,
					computed: '_computeTitleCo(model)'
				}
			},

			_computeTitleCo: function(model){
				return (model != null) ? model.sender.title + " at " + model.sender.company : "";
			},

			_computeFullName: function(model){
				return model.sender.firstName + " " + model.sender.lastName;
			},

			ready: function(){
				console.log(this.model);
			}



		});



	</script>


</dom-module>