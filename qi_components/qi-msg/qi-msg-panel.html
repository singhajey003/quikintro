<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-scroll-header-panel/core-scroll-header-panel.html">

<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/core-field/core-field.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-input/paper-input-decorator.html">
<link rel="import" href="../../bower_components/core-localstorage/core-localstorage.html">


<link rel="import" href="../qi-dialog/qi-msg-dialog.html">

<link rel="import" href="qi-msg-card.html">


<polymer-element name="qi-msg-panel" attributes="messages">
  <template>
  <link rel="stylesheet" href="../quikintro.css">
  <link rel="stylesheet" href="qi-msg-panel.css">
  

	<core-scroll-header-panel headermargin="128" condenses id="eventHeaderPanel" >

      <div id="contentTray" class="content">
        
        <template repeat="{{msg in messages}}">
          <qi-msg-card msg="{{msg}}"></qi-msg-card>
        </template>

        <qi-msg-dialog id="msgDialog"></qi-msg-dialog>
      
      </div>


     </core-scroll-header-panel>
   </template>

   <script>
	Polymer('qi-msg-panel',{

    messagesChanged: function(oldValue, newValue){
      console.log(newValue);
    },
  
    ready: function(){
      var msgDialog = this.$.msgDialog;
      var contentTray = this.$.contentTray;
      
      this.addEventListener("msgSent", function(e){
        var msgCard = new MsgCard();
        msgCard.msg = {
          sender : e.detail.sender,
          rcvr : e.detail.rcvr,
          msgText : e.detail.msg,
          tstamp : e.detail.tstamp,
        };

        
        var contentTray = this.$.contentTray;
        contentTray.addChildNode(msgCard);
        
      }),

      this.addEventListener("openPingDialog", function(e){
        msgDialog.open();
      })
    }
		
	    });

   </script>

</polymer-element>