<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html"> 
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html"> 

<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">


<link rel="import" href="qi-tweet-tray.html">
<dom-module id='qi-twitter-panel'  >

	<style>
	
	.label{
		font-size: 9pt;
		font-weight: bold;
		margin-right: 5px;
		color: #6c6c6c;
	}
	.value{
		font-size: 9pt;
		color: #5C9AA9;
	}
	</style>

 
	<template>

	<iron-ajax id="ajax"
	auto="true"
	  url="{{dataUrl}}"
	  handleAs="json"
	  on-response="handleResponse" last-response="{{response}}" on-error="errorHandler"></iron-ajax>

	<paper-header-panel class="flex fit layout vertical"> 

	 
		<div class="hashtagBanner layout horizontal">
			<div class="label">Event Hashtag:</div> 
		</div> 
	 
	    <qi-tweet-tray tweets="[[response.statuses]]" hashtag="[[hashtag]]"></qi-tweet-tray>
	</paper-header-panel>

	</template>


	<script>
		Polymer({
    		is: 'qi-twitter-panel', 

    		properties:{
    			dataUrl: {type: String, value:'', notify: true, observer: 'dataUrlChanged'},
    			hashtag: {type: String},
    			response: {type: Object, notify: true, observer: 'responseChanged'}
    		},

    		dataUrlChanged: function(newUrl, oldUrl){
    			
    		},

    		responseChanged:function(newResponse, oldResponse){
    			console.log(newResponse);
    		},

    		handleResponse: function(e){
    			console.log(e.detail.response);
    			console.log(e.detail.requestUrl);
    	// 		var streamTray = this.$.streamTray;
    	// 		var newResponse = e.detail.response;
    	// 		if(newResponse != null){
					// var values = newResponse.statuses;
					// for(var i=0; i < values.length; i++ ){
					// 	var childNode = new TwitterCard();
					// 	childNode.tweet = values[i];
					// 	streamTray.addChildNode(childNode);
					// }
    	// 		}
	    	},

	    	errorHandler: function(e){
	    		console.log(e);
	    	},

			ready: function(){
				
			},


			activate: function(){
				this.ajax.url = this.dataUrl;
				this.ajax.generateRequest();
			}
		
		});

	</script>

</dom-module> 