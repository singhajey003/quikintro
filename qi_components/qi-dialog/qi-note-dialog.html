<!--   -->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">

<link rel="import" href="../../bower_components/mat-dropdown/mat-dropdown.html">
<link rel="import" href="../../bower_components/mat-option/mat-option.html">


<dom-module id='qi-note-dialog'  >

	<link rel="stylesheet" href="../quikintro.css" > 
	<link rel="stylesheet" href="dialog.css"> 

	<template>

		<paper-dialog id="dialog" backdrop>
			<h2>New Note</h2>
			<div class="flex">
			<div>
				<paper-input id="title" floatingLabel="true" label="Title"></paper-input>
			</div>

			<div>
				<paper-textarea  floatingLabel="true" id="note" label="Note"></paper-textarea>
			</div>

			<div>
			<mat-dropdown id="type" model="{{noteType}}" label="Message Type" floating-label="true">
                    <mat-option value="public" label="Public"></mat-option>
                    <mat-option value="in-network" label="In-Network"></mat-option>
                    <mat-option value="private" label="Private"></mat-option>
              </mat-dropdown>  
			</div>
			</div>


			<div class="buttons flex">
			<paper-button dialog-dismiss>Cancel</paper-button>
			<paper-button dialog-confirm on-click="publishAction">Publish</paper-button> 
			</div>
		  
		</paper-dialog>

		
	</template>

	<script>
		Polymer({
    		is: 'qi-note-dialog', 

    		properties: {

    			/**
    			 * An array of notes.
    			 */
    			notes:{type: Array},

    			noteType:{
    				type: String,
    			}
    		},

    		/**
    		 * Publishes the note
    		 */
			publishAction: function(){

				if(this.notes == null){
					this.notes = [];
				}

				var timeObj = new Date();

				// get the profile for the current user and create an author from it
				var profile = JSON.parse(localStorage.getItem("profile"));
				var author = {
					"firstName":profile.firstName,
					"lastName":profile.lastName
				}

				note = {
					"title": this.$.title.value,
					"description": this.$.note.value,
					"author":author,
    				"time": timeObj.toDateString() + timeObj.toTimeString(),
    				"type": this.noteType
				};

				this.notes.push(note);
				

			},

			/**
			 * Opens the dialog.
			 */
			open: function(){
				this.reset();
				this.$.dialog.open();
			},

			/**
			 * Resets the dialog's title and note value.
			 */
			reset: function(){
				this.$.title.value = '';
				this.$.note.value = '';
			}

		});

	</script>

</dom-module> <!-- CONVERTED -->

<!-- CONVERSION NOTES TODO:
 Review code and look for: 
 - textContent binding from <div>First: {{first}}</div> TO First <span>{{first}}</span><br>
 - polymer-element default attributes such as tabindex="0" move to hostAttributes: {  tabindex: 0}
 - custom elements correct JSON quotes required, change from <my-element foo="{ 'title': 'Persuasion', 'author': 'Austen' }"> to </my-element> to <my-element foo="{ "title": "Persuasion", "author": "Austen" }"></my-element>
 - custom elements attribute use dash-case not camelCase, change from  <my-element fooBar= to <my-element foo-bar
 - Polymer( fix mixins use Behaviors after is: see https://www.polymer-project.org/1.0/docs/devguide/behaviors.html
 - Check layout attributes replaced by layout classes <div layout horizontal center>` to `<div class="layout horizontal center">, 
 - Cleanup class= 
 - Convert core- to iron- or paper- replacement elements at PolymerElements
 - Remove unresolved from <body> tag
 - Cleanup iron-ajax params url for embedded bindings {{}}
 - iron-ajax replace this.$.xxx_ajax.abort(); and this.$.xxx_ajax.go(); with this.$.xxx_ajax.generateRequest() 
 - Fix iron-list if needed 
 - Fix indentation as need 
 - Cleanup Comments to reflect changes ,
 - see https://www.polymer-project.org/1.0/docs/migration.html
   -->