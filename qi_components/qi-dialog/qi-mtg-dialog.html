<link rel="import" href="../../bower_components/paper-dialog/paper-action-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<polymer-element name="qi-mtg-dialog" contact="contact">

	<template>
 	<paper-action-dialog id="mtgDialog" heading="Create Meeting">
 		<link rel="stylesheet" href="dialog.css">

 		<paper-input id="title" label="Title"></paper-input>
 		<paper-input id="date" label="Date"></paper-input>
 		<paper-input id="time" label="Time"></paper-input>
 		<paper-input id="location" label="Location"></paper-input>
 		<paper-input id="msg" label="Message"></paper-input>


        <paper-button dismissive>Cancel</paper-button>
        <paper-button affirmative on-click="{{sendAction}}">Send</paper-button>
      </paper-action-dialog>
     </template>

     <script>
     Polymer('qi-mtg-dialog',{

     	sendAction: function(e){
     		var mtgs = JSON.parse(localStorage.getItem("mtgs"));
     		if (mtgs == null){
     			mtgs = [];
     		}

     		var profile = JSON.parse(localStorage.getItem("profile"));


     		var mtg = {
     			title: this.$.title.value,
     			date: this.$.date.value,
     			time: this.$.time.value,
     			location: this.$.location.value,
     			description: this.$.msg.value,
     			rcvr: this.contact,
     			sender: {
     				firstName: profile.firstName,
     				lastName: profile.lastName,
     				avatar: profile.avatar,
     				id: profile.id
     			}

     		};

     		mtgs.push(mtg);
     		localStorage.setItem("mtgs",JSON.stringify(mtgs));

               this.fire('mtg-sent', {mtg: mtg});

     	},

     	clear: function(){

     		var date = new Date();

     		this.$.title.value="";
     		this.$.date.value= date.toDateString()
     		this.$.time.value= date.toTimeString();
     		this.$.location.value = "";
     		this.$.msg.value = "";
     	},

     	open: function(){
     		this.clear();
     		this.$.mtgDialog.open();
     	},

     	close: function(){
     		this.$.mtgDialog.close();
     	}


     });


     </script>

</polymer>