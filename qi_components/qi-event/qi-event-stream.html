
<link rel="import" href="../../bower_components/core-pages/core-pages.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">

<link rel="import" href="../qi-global/global.html">
<link rel="import" href="qi-event-card.html">
<link rel="import" href="qi-event-detail.html">
<link rel="import" href="qi-event-notice.html">

<polymer-element name="qi-event-stream" >

	<template>

		<style>	
			.container{
				padding: 10px;
				height: 100%;
			}
		</style>

		<qi-globals id="globals"></qi-globals>
		<core-ajax auto url="{{$.globals.urls.events}}" response="{{events}}" handleAs="json"></core-ajax>

		<div class="container" layout vertical flex>

		<core-pages id="eventPages" selected="{{selectedEventPage}}" layout vertical flex>
		  <section selected>
			<label>My Scheduled Events</label>
			<div>
				<template repeat="{{event, i in events }}">
					<qi-event-card id="{{i}}" event="{{event}}" on-click="{{cardClickHandler}}"></qi-event-card>
				</template>
			</div>
		
		 </section>

		<section>
			<qi-event-detail id="detail"></qi-event-detail>
		</section>
		
		</div>
		</core-pages>
	</template>

	<script>
		Polymer('qi-event-stream',{
			selectedEventPage:0,
			selectedEventPageChanged: function(oldValue, newValue){
				console.log("newValue: " + newValue);
			},
			cardClickHandler: function(e){
				var event = e.srcElement.event;
				console.log("event: " + event);
				var detail = this.$.detail;
				detail.event = event;
				this.selectedEventPage = 1;
			},

			ready:function(){
				console.log("selectedEventPage: " + this.selectedEventPage);
				// var pages = this.$.eventPages;
				// pages.addEventListener('back-event', function(e){
				// 	e.currentTarget.selected = 0;
				// });
			}

		});


	</script>



</polymer-element>