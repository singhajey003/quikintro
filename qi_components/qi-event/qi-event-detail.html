<link rel="import" href="../../bower_components/polymer/layout.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-scroll-header-panel/core-scroll-header-panel.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-input/core-input.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">

<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">

<link rel="import" href="../../bower_components/paper-progress/paper-progress.html">

<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">


<link rel="import" href="../qi-twitter/qi-twitter-panel.html">
<link rel="import" href="../qi-contact/qi-contact-card.html">

<link rel="import" href="../qi-dialog/qi-invite-dialog.html">
<link rel="import" href="../qi-dialog/qi-msg-dialog.html">
<link rel="import" href="../qi-dialog/qi-mtg-dialog.html">



<link rel="import" href="../qi-global/global.html">
<link rel="import" href="qi-event-card.html">
<link rel="import" href="qi-event-detail-match.html">
<link rel="import" href="qi-meeting-card.html">
<link rel="import" href="qi-event-notes-panel.html">




<polymer-element name="qi-event-detail" attributes="event personas">
  <template>
  <link rel="stylesheet" href="../quikintro.css" >
  <link rel="stylesheet" href="qi-events.css" >
  <link rel="stylesheet" href="qi-event-detail.css" >


  
  <core-scroll-header-panel id="eventDetailHeaderPanel" fixed="" headerHeight="40" flex>

    <core-toolbar flex>
      <paper-tabs id="scrollableTabs" selected="{{selected}}" scrollable="" role="tablist" hideScrollButton="false" flex>
        <paper-tab role="tab" class="core-selected" >Summary</paper-tab>
        <paper-tab role="tab" >Matches</paper-tab>
        <paper-tab role="tab" >Contacts</paper-tab>
        <paper-tab role="tab" >Meetings</paper-tab>
        <paper-tab role="tab" >Tweets</paper-tab>
        <paper-tab role="tab" >Traits</paper-tab>
        <paper-tab role="tab" >Notes</paper-tab>      
      </paper-tabs>
    </core-toolbar>

    <div class="content" flex>
    <core-pages selected="{{selected}}">

      <div id="summary">
        <qi-event-summary event="{{event}}" personas="{{personas}}"></qi-event-summary>
      </div>

      <div id="matches">
        <template repeat="{{match in event.matches}}">
          <qi-event-detail-match match="{{match}}"></qi-event-detail-match>
        </template>
  
        <qi-invite-dialog id="inviteDialog"></qi-invite-dialog> 
      </div>

      <div id="contacts">
         <template repeat="{{contact in event.contacts}}">
          <qi-contact-card contact="{{contact}}"></qi-contact-card>
        </template> 
        <qi-mtg-dialog id="mtgDialog"></qi-mtg-dialog>
        <qi-msg-dialog id="msgDialog"></qi-msg-dialog>   
      </div>

      <div id="meetings">
        <template if="{{event.meetings == null || event.meetings.length == 0}}">
          <label>No Meetings Scheduled</label>
        </template>

        <template repeat="{{meeting in event.meetings}}">
          <qi-meeting-card meeting="{{meeting}}"></qi-meeting-card>
        </template>

      </div>


      <div id="twitter">
       <qi-twitter-panel dataUrl="{{event.tweetUrl}}" hashtag="{{event.hashtag}}"></qi-twitter-panel>
      </div>


      <div id="traits">

      <fieldset>
        <legend>My Interests</legend>
      
        <div class="keyword">drug discovery</div>
        <paper-progress class="type1" value="64"></paper-progress> 64%
        <div class="keyword">clinical trials</div>
        <paper-progress value="62" class="type2"></paper-progress> 62%
        <div class="keyword">cancer</div>
        <paper-progress value="34"></paper-progress> 34%
        <div class="keyword">systems biology</div>
        <paper-progress value="12" class="type2"></paper-progress> 12%
        

      </fieldset>

      <fieldset>
        <legend>Attendee Interests</legend>
      
        <core-label horizontal layout>
          <paper-checkbox ></paper-checkbox>
          <div vertical layout>
            <h4>investment - 64%</h4>
          </div>
        </core-label>


        <core-label horizontal layout>
          <paper-checkbox ></paper-checkbox>
          <div vertical layout>
            <h4>cancer immunotherapy - 62%</h4>
          </div>
        </core-label>

        <core-label horizontal layout>
          <paper-checkbox ></paper-checkbox>
          <div vertical layout>
            <h4>antibodies - 53%</h4>
          </div>
        </core-label>

        <core-label horizontal layout>
          <paper-checkbox ></paper-checkbox>
          <div vertical layout>
            <h4>clinical trial collaborations - 34%</h4>
          </div>
        </core-label>

        <core-label horizontal layout>
          <paper-checkbox ></paper-checkbox>
          <div vertical layout>
            <h4>ADCs - 12%</h4>
          </div>
        </core-label>



        </fieldset>

      </div>

      <div id="notes">
       <qi-event-notes-panel notes="{{event.notes}}"></qi-event-notes-panel>
      </div>
    </core-pages>
    </div>

    

   </template>

   <script>

  Polymer('qi-event-detail',{

        selected: 0,

        eventChanged: function(oldValue, newValue){
            var persona = null;
            var personas = JSON.parse(localStorage.getItem("personas"));

            for(var i=0; i < personas.length; i++){
              if(personas[i].name == newValue.persona){
                persona = personas[i];
                break;
              }
            }
            this.$.inviteDialog.persona = persona;
        },

        ready: function(){
          this.$.scrollableTabs.selected = 0;
          var inviteDialog = this.$.inviteDialog;

          this.addEventListener('openInviteDialog', function(e){
            inviteDialog.contact = e.detail.contact;
            inviteDialog.open();
          });

          var msgDialog = this.$.msgDialog;
          this.addEventListener("openPingDialog", function(e){
            msgDialog.contact = e.detail.contact;
            msgDialog.open();
          });

          var mtgDialog = this.$.mtgDialog;
          this.addEventListener("openMtgDialog", function(e){
            mtgDialog.contact = e.detail.contact;
            mtgDialog.open();
          });
          
        },

        backHandler: function(){
          this.fire('core-select', {panelTitle:'Event Stream', icon:'arrow-back', clickHandler: function(){}});
        }

    



       
    
      });

   </script>

</polymer-element>